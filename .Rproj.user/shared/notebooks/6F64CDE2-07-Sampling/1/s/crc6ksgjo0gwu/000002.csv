"0","# create utility functions"
"0","dnormfun <- function(x){"
"0","  return(dnorm(x,248))"
"0","}"
"0","plot_CI_cutoffs <- function(pct,zmin=-4,zmax=4,zmean=0,zsd=1) {"
"0","  zcut <- qnorm(1 - (1-pct)/2,mean=zmean,sd=zsd)"
"0","  zmin <- zmin*zsd + zmean"
"0","  zmax <- zmax*zsd + zmean"
"0","  x <- seq(zmin,zmax,0.1*zsd)"
"0","  zdist <- dnorm(x,mean=zmean,sd=zsd)"
"0","  p2 <- ggplot(data.frame(zdist=zdist,x=x),aes(x,zdist)) +"
"0","    xlab('Z score') + xlim(zmin,zmax) + ylab('density')+"
"0","    geom_line(aes(x,zdist),color='red',size=2) +"
"0","    stat_function(fun = dnorm, args=list(mean=zmean,sd=zsd),"
"0","                  xlim = c(zmean -zcut*zsd,zmean + zsd*zcut),"
"0","                  geom = ""area"",fill='orange')  +"
"0","    stat_function(fun = dnorm, args=list(mean=zmean,sd=zsd),"
"0","                  xlim = c(zmin,zmean -zcut*zsd),"
"0","                  geom = ""area"",fill='green')  +"
"0","    stat_function(fun = dnorm, args=list(mean=zmean,sd=zsd),"
"0","                  xlim = c(zmean +zcut*zsd,zmax),"
"0","                  geom = ""area"",fill='green')  +"
"0","    annotate('text',x=zmean,"
"0","             y=dnorm(zmean,mean=zmean,sd=zsd)/2,"
"0","             label=sprintf('%0.1f%%',area*100))  +"
"0","    annotate('text',x=zmean - zsd*zcut,"
"0","             y=dnorm(zmean-zcut*zsd,mean=zmean,sd=zsd)+0.05/zsd,"
"0","             label=sprintf('%0.2f',zmean - zsd*zcut))  +"
"0","    annotate('text',x=zmean + zsd*zcut,"
"0","             y=dnorm(zmean-zcut*zsd,mean=zmean,sd=zsd)+0.05/zsd,"
"0","             label=sprintf('%0.2f',zmean + zsd*zcut)) "
"0","  "
"0","    print(p2)"
"0","    return(zcut)"
"0","}"
"0","zcut <- plot_CI_cutoffs(0.95)"
